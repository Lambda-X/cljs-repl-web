# Clojure Web Repl ([clojurescript.io](http://www.clojurescript.io))


A reagent app designed to embed a pure ClojureScript REPL in a web
page. Plumbing kindly provided by
[replumb](https://github.com/ScalaConsultants/replumb).

This project also employs the following libraries, whose authors we thank:

* [regent](https://github.com/reagent-project/reagent)
* [re-frame](https://github.com/Day8/re-frame)
* [re-com](https://github.com/Day8/re-com)
* [markdown-clj](https://github.com/yogthos/markdown-clj)
* [hickory](https://github.com/davidsantiago/hickory)
* [CodeMirror](https://github.com/codemirror/CodeMirror)
* [showdown](https://github.com/showdownjs/showdown)
* [enquire.js](https://github.com/WickyNilliams/enquire.js)
* ...and more

Last but not least, many kudos go to [@jaredly](https://github.com/jaredly) and
his [Reepl](https://github.com/jaredly/reepl) with which we share the
CodeMirror implementation (and yes, the plan is to create a separate component
library with it).

## Development

With `dev` profile and `:optimizations :none`, an `out` folder containing all
the compiled dependencies will be created in the same folder of
`cljs-repl-web.js` in `resources/public/js/compiled`. Hold on to this folder.

### Generate the ClojureScript API 

To generate the doc panel, this project performs a simple transformation of the
data taken from the amazing work at
[cljs-api-info](https://github.com/cljsinfo/cljs-api-docs). The new doc will be
stored in the `cljs-repl-web.cljs-api` namespace.

The generator/transformer needs the `cljs-api.edn` file from the project. One
easy way is to get it is to checkout a
[tag](https://github.com/cljsinfo/cljs-api-docs/tree/1.7.228) and copy it to
`resources`.

Then run:

`lein run -m cljs-api.generator/-main`

#### Figwheel

`lein fig-dev` **or** `lein fig-dev*` if you want to clean as well. Browse to
[http://localhost:3449](http://localhost:3449).

#### Config

The `cljs-repl-web.config/defaults` var contains the configuration map:

```
{:name "Clojurescript.io Website"
 :production? true|false
 :base-path "root/"
 :core-cache-url "/my-cache/core.cljs.cache.aot.json")
 :src-paths ["/some/path1" "/some/path2")]
 :verbose-repl? true|false}
```

#### Serve files

There in an alias to serve the content but it requires a
[custom version](https://github.com/tailrecursion/lein-simpleton/pull/7) of
`lein-simpleton`:

```
git clone -b from-fix git@github.com:arichiardi/lein-simpleton.git
cd lein-simpleton
lein install
```

At this point you can launch `lein serve-dev` or `lein serve-prod`.

## Production Build

Remember the `out` folder?

For having a
[working (require)](http://blog.scalac.io/2015/12/21/cljs-replumb-require.html),
that folder generated by `lein cljsbuild once dev` needs to be uploaded to the
web server. This will be improved: an additional plugin/tool could collect all
the necessary sources from `project.clj` and pack them in an optimized way
easily.

At the moment the project reads sources from `/cljs-src` if compiled with
`prod` profile or from `js/compiled/out` if compiled with `dev` profile.

For the `prod` artifact run `lein minify*`, the asterisk adds `lein clean`.

## Testing

Tests at the moment complete in PhantomJS and SlimerJS, but are just a few.

You can test inside the browser's Developer Console after having booted
Figwheel using `luncher.test.run()`.

For headless tests you need first of all
[PhantomJS](https://github.com/ariya/phantomjs/) and/or
[SlimerJS](http://slimerjs.org/), after which you can: `lein test-phantom`
and/or `lein test-slimer` respectively. Featuring
[doo](https://github.com/bensu/doo) here.

## Other Resources

 * [CLJSJS](https://github.com/cljsjs/packages)


### License

Distributed under the Eclipse Public License, the same as Clojure.

Copyright (C) 2015-16 Scalac Sp. z o.o.

Scalac [scalac.io](http://scalac.io/?utm_source=scalac_github&utm_campaign=scalac1&utm_medium=web) is a full-stack team of great functional developers focused around Scala/Clojure backed by great frontend and mobile developers.

On our [blog](http://blog.scalac.io/?utm_source=scalac_github&utm_campaign=scalac1&utm_medium=web) we share our knowledge with community on how to write great, clean code, how to work remotely and about our culture.
